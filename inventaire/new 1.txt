<h1><span style="text-decoration: underline;">1. INSTALLATION ANSIBLE </span></h1>

<pre class="lang:ssh decode:true ">yum install epel-release
</pre>

<pre class="lang:ssh decode:true ">yum -y update
</pre>

<pre class="lang:ssh decode:true ">yum install ansible
</pre>

<h1><span style="text-decoration: underline;">2. CONTROLE INSTALLATION</span></h1>

<pre class="lang:ssh decode:true ">ansible --version
</pre>

<h1><span style="text-decoration: underline;">3. PARAMETRAGE DE CONTROLE A DISTANCE</span></h1>

<pre class="lang:ssht decode:true ">ssh-keygen
</pre>

<pre class="lang:ssh decode:true ">Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): #laissez vide <Entrée>
Enter passphrase (empty for no passphrase): #NE PAS LAISSER LE CHAMP VIDE<Entrée>
Enter same passphrase again: #NE PAS LAISSER LE CHAMP VIDE<Entrée>
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:wyPIsGjtVP9jMjGr3m3q6JTPunFq2U8NELBs9Hf98/k root@ansible
The key's randomart image is:
+---[RSA 2048]----+
|     o..         |
|    o o .   .    |
|  .  = o . . .   |
| ..+o...o .   .  |
|...oo .+S.     o |
|. o   ..=oo     +|
|   . +o= = .   ..|
|    .oX.*..     .|
|    +O+*+o      E|
+----[SHA256]-----+
</pre>

<pre class="lang:ssh decode:true ">ssh-copy-id root@host-exemple
</pre>

<pre class="lang:ssh decode:true ">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
The authenticity of host 'host-exemple (host-exemple)' can't be established.
RSA key fingerprint is SHA256:vL55i7RpHXCUczkiSorPMph8x9MiNb5L4Z8r4ElaCAg.
RSA key fingerprint is MD5:42:69:37:89:01:49:ca:12:d6:cb:69:9c:38:b9:7c:06.
Are you sure you want to continue connecting (yes/no)?# yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@host-exemple's password:# mot de passe root de Centreon Server
Number of key(s) added: 1
Now try logging into the machine, with:   "ssh 'root@host-exemple0'"
and check to make sure that only the key(s) you wanted were added.
</pre>

<pre class="lang:ssh decode:true ">ssh-add .ssh/id_rsa
</pre>

<pre class="lang:ssh decode:true ">eval $(ssh-agent)
</pre>

<pre class="lang:ssh decode:true ">ssh 'root@host-exemple'
</pre>

<pre class="lang:ssh decode:true ">exit
</pre>

<pre class="lang:ssh decode:true ">ansible -m ping host-exemple
</pre>

<pre class="lang:ssh decode:true ">exit
</pre>

<h1><span style="text-decoration: underline;">4. PARAMETRAGE ANSIBLE</span></h1>

<pre class="lang:ssh decode:true ">nano /etc/ansible/hosts
</pre>

<pre class="lang:txt decode:true ">[all:vars]
ansible_connection=local

[tomcat]
prod-haproxy

[apache]
prod-apache-1
prod-apache-2

[mysql]
prod-mysql-[1:2]

[active-directory]
active-directory-1

[linux:children]
apache
mysql

[windows:children]
active-directory

[windows:vars]
ansible_connection=winrm
</pre>

<pre class="lang:ssh decode:true ">mkdir /etc/ansible/group_vars
</pre>

<pre class="lang:ssh decode:true ">nano /etc/ansible/group_vars/mysql
</pre>

<pre class="lang:txt decode:true ">---
...
</pre>

<pre class="lang:ssh decode:true ">nano /etc/ansible/group_vars/all
</pre>

<pre class="lang:txt decode:true ">---
...
</pre>

<h1><span style="text-decoration: underline;">5. FICHIER INVENTAIRE LINUX</span></h1>


<h1><span style="text-decoration: underline;">6. FICHIER INVENTAIRE WINDOWS</span></h1>

<pre class="lang:txt decode:true ">
[windows]
host-exemple

[win:vars]
ansible_user=administrator
ansible_password=XXXXXXXX
ansible_connection=winrm
ansible_winrm_server_cert_validation=ignore
</pre>